<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Interpolate Dormand-Prince output — dopri_interpolate • dde</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Interpolate Dormand-Prince output — dopri_interpolate" />
<meta property="og:description" content="Interpolate the Dormand-Prince output after an integration.  This
only interpolates the core integration variables and not any
additional output variables." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dde</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dde.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mrc-ide/dde/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Interpolate Dormand-Prince output</h1>
    <small class="dont-index">Source: <a href='https://github.com/mrc-ide/dde/blob/master/R/dopri.R'><code>R/dopri.R</code></a></small>
    <div class="hidden name"><code>dopri_interpolate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Interpolate the Dormand-Prince output after an integration.  This
only interpolates the core integration variables and not any
additional output variables.</p>
    </div>

    <pre class="usage"><span class='fu'>dopri_interpolate</span><span class='op'>(</span><span class='va'>h</span>, <span class='va'>t</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>h</th>
      <td><p>The interpolation history.  This can be the output
running <code>dopri</code> with <code>return_history = TRUE</code>, or the
history attribute of this object (retrievable with
<code><a href='https://rdrr.io/r/base/attr.html'>attr(res, "history")</a></code>).</p></td>
    </tr>
    <tr>
      <th>t</th>
      <td><p>The times at which interpolated output is required.
These times must fall within the included history (i.e., the
times that the original simulation was run) or an error will be
thrown.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This decouples the integration of the equations and the generation
of output; it is not necessary for use of the package, but may
come in useful where you need to do (for example) root finding on
the time course of a problem, or generate minimal output in some
cases and interrogate the solution more deeply in others.  See the
examples and the package vignette for a full worked example.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Rich FitzJohn</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Here is the Lorenz attractor implemented as an R function</span>
<span class='va'>lorenz</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>t</span>, <span class='va'>y</span>, <span class='va'>p</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>sigma</span> <span class='op'>&lt;-</span> <span class='va'>p</span><span class='op'>[[</span><span class='fl'>1L</span><span class='op'>]</span><span class='op'>]</span>
  <span class='va'>R</span> <span class='op'>&lt;-</span> <span class='va'>p</span><span class='op'>[[</span><span class='fl'>2L</span><span class='op'>]</span><span class='op'>]</span>
  <span class='va'>b</span> <span class='op'>&lt;-</span> <span class='va'>p</span><span class='op'>[[</span><span class='fl'>3L</span><span class='op'>]</span><span class='op'>]</span>
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>sigma</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>y</span><span class='op'>[[</span><span class='fl'>2L</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>y</span><span class='op'>[[</span><span class='fl'>1L</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>,
    <span class='va'>R</span> <span class='op'>*</span> <span class='va'>y</span><span class='op'>[[</span><span class='fl'>1L</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>y</span><span class='op'>[[</span><span class='fl'>2L</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>y</span><span class='op'>[[</span><span class='fl'>1L</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>*</span> <span class='va'>y</span><span class='op'>[[</span><span class='fl'>3L</span><span class='op'>]</span><span class='op'>]</span>,
    <span class='op'>-</span><span class='va'>b</span> <span class='op'>*</span> <span class='va'>y</span><span class='op'>[[</span><span class='fl'>3L</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>y</span><span class='op'>[[</span><span class='fl'>1L</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>*</span> <span class='va'>y</span><span class='op'>[[</span><span class='fl'>2L</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Standard parameters and a reasonable starting point:</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>28</span>, <span class='fl'>8</span> <span class='op'>/</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>y0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>

<span class='co'># Run the integration for times [0, 50] and return minimal output,</span>
<span class='co'># but *do* record and return history.</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='dopri.html'>dopri</a></span><span class='op'>(</span><span class='va'>y0</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>50</span><span class='op'>)</span>, <span class='va'>lorenz</span>, <span class='va'>p</span>,
           n_history <span class='op'>=</span> <span class='fl'>5000</span>, return_history <span class='op'>=</span> <span class='cn'>TRUE</span>,
           return_time <span class='op'>=</span> <span class='cn'>FALSE</span>, return_initial <span class='op'>=</span> <span class='cn'>FALSE</span>,
           return_by_column <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'># Very little output is returned (just 3 numbers being the final</span>
<span class='co'># state of the system), but the "history" attribute is fairly</span>
<span class='co'># large matrix of history information.  It is not printed though</span>
<span class='co'># as its contents should not be relied on.  What does matter is</span>
<span class='co'># the range of supported times printed (i.e., [0, 50]) and the</span>
<span class='co'># number of entries (~2000).</span>
<span class='va'>y</span>
</div><div class='output co'>#&gt;          [,1]
#&gt; [1,]  4.71880
#&gt; [2,]  7.09094
#&gt; [3,] 17.02268
#&gt; attr(,"history")
#&gt; &lt;dopri_history&gt;
#&gt;   - equations: 3
#&gt;   - time: [0, 50]
#&gt;   - entries: 2128
#&gt;   - order: 5</div><div class='input'>
<span class='co'># Generate an interpolated set of variables using this; first for</span>
<span class='co'># 1000 steps over the full range:</span>
<span class='va'>tt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>50</span>, length.out <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>
<span class='va'>yy</span> <span class='op'>&lt;-</span> <span class='fu'>dopri_interpolate</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>tt</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>yy</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>]</span>, type <span class='op'>=</span> <span class='st'>"l"</span><span class='op'>)</span>
</div><div class='img'><img src='dopri_interpolate-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Then for 50000</span>
<span class='va'>tt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>50</span>, length.out <span class='op'>=</span> <span class='fl'>50000</span><span class='op'>)</span>
<span class='va'>yy</span> <span class='op'>&lt;-</span> <span class='fu'>dopri_interpolate</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>tt</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>yy</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>]</span>, type <span class='op'>=</span> <span class='st'>"l"</span><span class='op'>)</span>
</div><div class='img'><img src='dopri_interpolate-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Rich FitzJohn, Wes Hinsley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


